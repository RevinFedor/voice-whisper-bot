# –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram –±–æ—Ç–æ–≤ –Ω–∞ Telegraf

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê

### 1. –ü–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
**–í–°–ï–ì–î–ê –æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:**
```javascript
// 1. –°–Ω–∞—á–∞–ª–∞ –∫–æ–º–∞–Ω–¥—ã (bot.command)
bot.command('start', ...);
bot.command('help', ...);
bot.command(['collect', '–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞'], ...);

// 2. –ó–∞—Ç–µ–º actions (bot.action) 
bot.action('callback_data', ...);

// 3. –í –∫–æ–Ω—Ü–µ –æ–±—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (bot.on)
bot.on('text', ...);
bot.on('voice', ...);
bot.on('video', ...);
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:** Telegraf –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç middleware –≤ –ø–æ—Ä—è–¥–∫–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –ï—Å–ª–∏ `bot.on('text')` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω —Ä–∞–Ω—å—à–µ –∫–æ–º–∞–Ω–¥, –æ–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç –∫–æ–º–∞–Ω–¥—ã –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –¥–æ–π–¥—É—Ç –¥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥.

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö —Ç–µ–∫—Å—Ç–∞
```javascript
bot.on('text', async (ctx) => {
    // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã!
    if (ctx.message.text.startsWith('/')) return;
    
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞
});
```

### 3. –ò–∑–±–µ–≥–∞–π—Ç–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥
- –ù–µ –æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ü—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ —É–¥–∞–ª—è–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ –ø–æ —Ñ–∞–π–ª—É –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ –±–æ—Ç–∞
```javascript
// 1. –ò–º–ø–æ—Ä—Ç—ã
import { Telegraf } from 'telegraf';

// 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const bot = new Telegraf(TOKEN);

// 3. –•—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
const userStates = new Map();

// 4. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function helperFunction() {}

// 5. –ö–û–ú–ê–ù–î–´ (bot.command) - –í–°–ï–ì–î–ê –ü–ï–†–í–´–ú–ò!
bot.command('start', ...);

// 6. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ (bot.action)
bot.action('button_callback', ...);

// 7. –û–±—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (bot.on) - –í–°–ï–ì–î–ê –ü–û–°–õ–ï–î–ù–ò–ú–ò!
bot.on('text', ...);
bot.on('voice', ...);

// 8. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.launch();
```

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

- [ ] –ö–æ–º–∞–Ω–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –î–û –≤—Å–µ—Ö `bot.on()` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ
- [ ] –í `bot.on('text')` –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥
- [ ] –ö–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `bot.telegram.setMyCommands()` –¥–ª—è –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞
- [ ] –ö–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ø—Ä–∞–≤–∫—É `/help`

## üîç –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–º–∞–Ω–¥–∞–º–∏

### –ö–æ–º–∞–Ω–¥–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–∫–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –î–û `bot.on()`)
2. –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–æ –∫–æ–º–∞–Ω–¥—ã:
   ```javascript
   bot.command('mycommand', async (ctx) => {
       console.log('–ö–æ–º–∞–Ω–¥–∞ –≤—ã–∑–≤–∞–Ω–∞:', ctx.from.username);
       // ...
   });
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `bot.on('text')` –µ—Å—Ç—å `if (ctx.message.text.startsWith('/')) return;`

### –ö–æ–º–∞–Ω–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–≤–∞–∂–¥—ã:
1. –ù–∞–π–¥–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã: `grep "bot.command.*mycommand" index.js`
2. –£–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
```bash
grep -n "^bot\.(command|on|action)" index.js
```

### –ü–æ–∏—Å–∫ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∫–æ–º–∞–Ω–¥:
```bash
grep -n "bot.command.*'–∫–æ–º–∞–Ω–¥–∞'" index.js | wc -l
```
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç > 1, –µ—Å—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –ø–æ—Å–ª–µ `bot.on('text')`** - –∫–æ–º–∞–Ω–¥—ã –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `/` –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Ç–µ–∫—Å—Ç–∞** - –∫–æ–º–∞–Ω–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥** - –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `bot.hears()` –≤–º–µ—Å—Ç–æ `bot.command()`** - –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–æ –¥–ª—è –∫–æ–º–∞–Ω–¥

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Telegraf –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ middleware](https://telegraf.js.org/classes/Telegraf.html#middleware)
- [–ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ Telegraf](https://github.com/telegraf/telegraf/issues/705)